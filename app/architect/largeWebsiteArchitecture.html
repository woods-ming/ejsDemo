<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>CodeExperience</title>
    <meta name="author" content="胡明明" />
    <meta name="keywords" content="大型网站，架构要素" />
    <meta name="description" content="了解网站大型化的过程中，遇到的经典问题，及如何解决这些问题">
    <link rel="shortcut icon" href="/favicon.ico">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <!-- CDN -->
    <link href="http://cdn.bootcss.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/prettify/r298/prettify.min.css" rel="stylesheet">

    <!-- build:css /styles/main.css -->
    <link rel="stylesheet" href="/styles/docs.min.css">
    <link rel="stylesheet" href="/styles/patch.css">
    <link rel="stylesheet" href="/styles/prettify.css">
    <!-- endbuild -->

</head>
<body data-spy="scroll" data-offset="100" data-target="#catalog">
    <a id="skippy" class="sr-only sr-only-focusable" href="#content">
        <div class="container">
            <span class="skiplink-text">Skip to main content</span>
        </div>
    </a>

    <!-- 导航 -->
    <header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="#" class="navbar-brand">CodeExperience</a>
            </div>
            <nav class="collapse navbar-collapse bs-navbar-collapse">
                <ul class="nav navbar-nav">
    <li><a href="#">简介</a></li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">速记手册 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="#">Html</a></li>
            <li><a href="#">Css</a></li>
            <li><a href="#">Javascript</a></li>
            <li><a href="#">jQuery</a></li>
            <li class="divider"></li>
            <li><a href="#">C#</a></li>
            <li><a href="#">Java</a></li>
            <li><a href="#">Sql</a></li>
            <li class="divider"></li>
            <li><a href="#">Git</a></li>
            <li><a href="#">Yeoman</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">编程基础 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/basic/CodingSpec.html">基本编程规范</a></li>
            <li><a href="#">C# 编程规范</a></li>
            <li><a href="#">Effective C#</a></li>
            <li><a href="#">OOD启思录</a></li>
            <li class="divider"></li>
            <li><a href="#">性能优化</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">设计模式 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/design_pattern/create.html">创建型模式</a></li>
            <li><a href="/design_pattern/struct.html">结构型模式</a></li>
            <li><a href="/design_pattern/behavior.html">行为型模式</a></li>
            <li class="divider"></li>
            <li><a href="#">设计模式总结</a></li>
            <li><a href="#">面向对象设计原则</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">架构模式 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/architect/enterpriseApplicationArchitecture.html">企业应用架构模式</a></li>
            <li><a href="/architect/largeWebsiteArchitecture.html">大型网站技术架构</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">项目管理 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/project_management/DevelopmentProcess.html">软件开发流程</a></li>
            <li><a href="#">持续集成</a></li>
            <li><a href="/project_management/ProjectPlan.html">项目计划、进度与控制</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">杂谈 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/talk/terms.html">计算机名词</a></li>
            <li><a href="#">如何做SEO</a></li>
            <li><a href="#">如何选择控件</a></li>
            <li><a href="#">Yeoman为何流行</a></li>
        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">自学经历 <span class="caret"></span></a>
        <ul class="dropdown-menu" role="menu">
            <li><a href="/learn/java.html">Java入门</a></li>
        </ul>
    </li>
</ul>

<!-- <ul class="nav navbar-nav navbar-right">
    <li><a href="#" target="_blank"></a></li>
</ul> -->
            </nav>
        </div>
    </header>

    <!-- 论文简介 -->
    <div class="bs-docs-header" id="content" tabindex="-1">
        <div class="container">
            <h1>大型网站技术架构</h1>
            <p>摘要: 了解网站大型化的过程中，遇到的经典问题，及如何解决这些问题</p>
            <p>关键字: 大型网站，架构要素</p>
        </div>
    </div>

    <div class="container bs-docs-container">
        <div class="row">
            <div class="col-md-9" role="main">
                <!-- 正文 -->
                <div>
                    

	<h2 class="page-header" id="0">一、大型网站概述</h2>

	

	<div class="bs-docs-section">

	

			<h3 id="0-0">1.核心思想</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>演化</dt>
						<dd>大型网站是由小网站逐渐演化而来（不是一蹴而就）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>驱动</dt>
						<dd>业务是技术的驱动力，不断增长的业务推动了网站技术的发展</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="0-1">2.大型网站架构的发展历程</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>单服务器</dt>
						<dd>应用、文件、数据库集中在一台服务器上</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>应用、数据分离</dt>
						<dd>应用服务器 + 文件服务器 + 数据库服务器</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分布式数据缓存</dt>
						<dd>80%的业务集中在20%的数据，将这部分数据缓存（数据提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>应用服务器集群</dt>
						<dd>通过负载均衡，提高可接收请求的上限（应用提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>数据库读写分离</dt>
						<dd>主从热备，主数据库负责写，从数据库负责读（数据提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>使用CDN和反向代理</dt>
						<dd>CDN缓存静态资源，反向代理缓存业务数据（数据提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分布式数据库</dt>
						<dd>单表数据规模非常庞大时使用（数据提量提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>NoSql数据库</dt>
						<dd>天生就是用来解决大数据量和高性能问题的（数据提量提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>业务纵向拆分</dt>
						<dd>将大网站拆分为多个松耦合的小网站，通过超链接、消息队列、数据库通信（应用提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分布式服务</dt>
						<dd>先横向拆分出服务层，再纵向拆分服务，分别发布在不同的服务器集群中（应用提速）</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="0-2">3.大型网站的特点</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>大数据</dt>
						<dd>用户多，因此产生的业务数据和用户数据多</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>高并发、大流量</dt>
						<dd>用户多，因此单位时间请求量大</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>必须高可用</dt>
						<dd>用户多，一旦宕机，波及范围广、损失大</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>网络情况复杂</dt>
						<dd>用户多，且分属在不同的网络环境中</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>安全环境恶劣</dt>
						<dd>树大招风，成为众多黑客攻击或炫耀的对象</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>渐进式发展</dt>
						<dd>市场变化快，不可能一开始就捕获所有 功能性和非功能性 需求</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>发布频繁</dt>
						<dd>为快速响应用户需求，频繁增量迭代</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="0-3">4.大型网站解决问题的思路</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>分层</dt>
						<dd>横向切分，定义层次边界和接口（合理的分配职责）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分割</dt>
						<dd>纵向切分，根据“高内聚、低耦合”定义模块（使模块独立）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分布式</dt>
						<dd>切分后的模块，部署在不同的服务器上（分工协作）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>集群</dt>
						<dd>多台服务器干同一件事情（人多力量大，并可相互替代）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>缓存</dt>
						<dd>将经常访问的数据，暂存到可以快速读取的地方（访问提速）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>异步</dt>
						<dd>将一个业务操作分成多个步骤，通过消息队列联系相邻的步骤（使步骤独立）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>冗余</dt>
						<dd>服务器和数据多做几个备份（增加后备力量，应付突发情况）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>自动化流程</dt>
						<dd>开发、维护过程中的固定步骤，用程序描述出来，交给计算机来做</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>安全</dt>
						<dd>漏洞扫描 + 加密技术 + 信息过滤 + 风险控制</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="0-4">5.大型网站架构的核心要素</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>性能</dt>
						<dd>（现在）响应迅速</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>伸缩性</dt>
						<dd>通过增加硬件，使性能（在未来）提升</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>扩展性</dt>
						<dd>容易（在未来）增加功能</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>可用性</dt>
						<dd>（一直）稳定，不报错</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>安全性</dt>
						<dd>（一直）抵御恶意攻击</dd>
					</dl>

					

			

			

			</div>

		

	</div>



	<h2 class="page-header" id="1">二、如何提升核心架构要素？</h2>

	

	<div class="bs-docs-section">

	

			<h3 id="1-0">1.性能：及时响应</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>改善交互</dt>
						<dd>先反馈信息，再慢慢干活（快慢是一种主观感受）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>减少响应时间</dt>
						<dd>改进算法 || 缩短通信时间</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>增加硬件</dt>
						<dd>用硬件资源换性能（人多力量大）</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="1-1">2.伸缩性：充分发挥硬件的能力</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>分布式</dt>
						<dd>以功能为单位，分别部署到不同服务器上</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>集群</dt>
						<dd>一项功能，部署到服务器集群上</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>负载均衡</dt>
						<dd>作为代理服务器，感知集群中各个服务器的负载情况，并将请求转发到负载最低的服务器</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>NoSQL数据库</dt>
						<dd>非关系的、分布式数据库设计模式（分布式增强伸缩性）</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="1-2">3.扩展性：对扩展开放，对修改关闭</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>低耦合</dt>
						<dd>定义接口、切分模块（单一职责），职责越简单，耦合性就越小</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>消息队列</dt>
						<dd>用事件机制耦合接口，调用方生产消息存入队列，被调用方读取队列消费消息</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>分布式部署</dt>
						<dd>各个模块独立运行（修改一个，不影响其它模块正常运行）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>NoSQL数据库</dt>
						<dd>数据结构可扩展</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="1-3">4.可用性：少出故障，快速恢复</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>度量方法</dt>
						<dd>可用性 = ( 1 - 故障时间 / 年度总时间 ) × 100%</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>资源冗余</dt>
						<dd>备份服务器和数据（坏了可以恢复）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>失效转移</dt>
						<dd>通过负载均衡，将请求转移给能够处理它的服务器（找到可替代的人）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>幂等性设计</dt>
						<dd>服务可重复执行（不因执行次数，影响处理结果）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>自动化流程</dt>
						<dd>通过持续集成、自动化监测，使用固定步骤尽早发现故障，尽早解决（提前预防，快速响应）</dd>
					</dl>

					

			

			

			</div>

		

			<h3 id="1-4">5.安全性：提高攻击门槛</h3>
			<div class="section">

			

					<dl class="dl-horizontal">
						<dt>拒绝请求</dt>
						<dd>拒绝包含js或SQl的请求（不让逻辑执行）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>对输入消毒</dt>
						<dd>将js和Sql转化为普通文本（使注入逻辑失效）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>SQL语句参数化</dt>
						<dd>不通过拼接的方式构造SQL语句（使注入逻辑失效）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>HttpOnly</dt>
						<dd>给存储session的cookie加HttpOnly标记（使cookie不能被js操作）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>表单Token</dt>
						<dd>把信物放到表单中，确保post请求来自本网站（拒绝伪造的表单请求）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>过滤上传文件</dt>
						<dd>服务器拒绝可执行文件（不让逻辑注入）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>加密</dt>
						<dd>保护敏感信息（无法解密，拿到也没用）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>信息过滤</dt>
						<dd>处理敏感词汇（不传播非法信息）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>黑名单</dt>
						<dd>对于黑名单中的用户，关注或限制其操作（针对人进行防范）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>Web应用防火墙</dt>
						<dd>根据内置的安全规则，对请求进行分析处理（针对可疑请求）</dd>
					</dl>

					

					<dl class="dl-horizontal">
						<dt>Web安全漏洞扫描</dt>
						<dd>根据内置的安全规则，模拟黑客攻击，测试网站的安全性（全面检查，增强信心）</dd>
					</dl>

					

			

			

			</div>

		

	</div>


                </div>

                <div class="bs-callout bs-callout-info">
	<!-- <h4>注:</h4> -->
	<p class="text-info">
		

			1.高手的养成：遇到了常人难以遇到的问题，并解决了（积累经验的机会多）<br />

			

			2.业务问题可以由技术手段和业务手段来解决（不要禁锢解决问题的方式）<br />

			
	</p>
</div>
            </div>
            <div class="col-md-3" role="complementary">
                <!-- 目录 -->
                <nav id="catalog" class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" data-spy="affix" data-offset-top="320">
                    <ul class="nav bs-docs-sidenav">

    

            <li>
                <a href="#0">一、大型网站概述</a>
                <ul class="nav">

                    

                        <li><a href="#0-0">1.核心思想</a></li>

                        

                        <li><a href="#0-1">2.大型网站架构的发展历程</a></li>

                        

                        <li><a href="#0-2">3.大型网站的特点</a></li>

                        

                        <li><a href="#0-3">4.大型网站解决问题的思路</a></li>

                        

                        <li><a href="#0-4">5.大型网站架构的核心要素</a></li>

                        

                </ul>
            </li>

            

            <li>
                <a href="#1">二、如何提升核心架构要素？</a>
                <ul class="nav">

                    

                        <li><a href="#1-0">1.性能：及时响应</a></li>

                        

                        <li><a href="#1-1">2.伸缩性：充分发挥硬件的能力</a></li>

                        

                        <li><a href="#1-2">3.扩展性：对扩展开放，对修改关闭</a></li>

                        

                        <li><a href="#1-3">4.可用性：少出故障，快速恢复</a></li>

                        

                        <li><a href="#1-4">5.安全性：提高攻击门槛</a></li>

                        

                </ul>
            </li>

            

</ul>
                    <a class="back-to-top" href="#top">
                        返回顶部
                    </a>
                </nav>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bs-docs-footer" role="contentinfo">
  <div class="container">
    <p>本网站由 <a href="#" target="_blank">胡明明</a> 在业余时间归纳总结。所有内容基于个人理解，仅用于参考，不保证正确性。</p>
	<p>版权所有，保留一切权利。</p>
  </div>
</footer>


    <!-- CDN -->
    <script src="http://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
    <script src="http://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="http://cdn.bootcss.com/prettify/r298/prettify.min.js"></script>

    <!-- build:js /scripts/main.js -->
    <script src="/scripts/main.js"></script>
    <script src="/scripts/prettyCode.js"></script>
    <!-- endbuild -->
</body>
</html>